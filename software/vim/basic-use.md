# 基础使用

## 光标移动

该节的所有跳转均可以使用 `<C-o>` 进行快速返回

### motion

语法：

- `[number] + motion = motion ... motion`，`number` 表示光标移动的单位数，`motion` 为如下的命令

|    按键     |                   意义                    |                       备注                        |
| :---------: | :---------------------------------------: | :-----------------------------------------------: |
|    `g_`     |           本行最后一个非空字符            |                                                   |
|     `^`     |             本行首个非空字符              |                                                   |
|    `g^`     |                                           |                                                   |
|     `_`     |                                           |                                                   |
|     `$`     |                 本行行尾                  |                                                   |
|    `g$`     |                                           |                                                   |
|   `<End>`   |                                           |                                                   |
|  `g<End>`   |                                           |                                                   |
|     `0`     |                 本行行首                  |                                                   |
|  `<Home>`   |                                           |                                                   |
|  `g<Home>`  |                                           |                                                   |
|     `+`     |            下一行首个非空字符             |                                                   |
|     `-`     |            上一行首个非空字符             |                                                   |
|     `)`     |                下一个句子                 |                                                   |
|     `(`     |                上一个句子                 |                                                   |
|     `}`     |                 下一段落                  |                                                   |
|     `{`     |                 上一段落                  |                                                   |
|    `]]`     |                                           |                                                   |
|    `][`     |                                           |                                                   |
|    `[[`     |                                           |                                                   |
|    `[]`     |                                           |                                                   |
|     `w`     |              下一个 word 头               |      w = word，word 表示以非空字符分割的单词      |
|    `ge`     |              上一个 word 尾               |                                                   |
|     `e`     |                  word 尾                  |  e = end，若已是 word 尾，则跳转到下一个 word 尾  |
|     `b`     |                  word 头                  | b = begin，若已是 word 头，则跳转到上一个 word 头 |
|     `W`     |              下一个 WORD 头               |      W = WORD，WORD 表示以空白字符分割的单词      |
|    `gE`     |              上一个 WORD 尾               |                                                   |
|     `E`     |                  WORD 尾                  |      若已是 WORD 尾，则跳转到下一个 WORD 尾       |
|     `B`     |                  WORD 头                  |      若已是 WORD 头，则跳转到上一个 WORD 头       |

### 其他跳转

|    按键     |                   意义                    |                       备注                        |
| :---------: | :---------------------------------------: | :-----------------------------------------------: |
|     `G`     |                 文件结尾                  |                                                   |
|    `gg`     |                 文件开头                  |                                                   |
|     `%`     | 光标所在括号（`{`、`[`、`(`）相匹配的括号 |                                                   |
|  `f[char]`  |                下一个 char                |        f = find，配合`;`下一个，`,`上一个         |
|  `F[char]`  |                上一个 char                |                                                   |
|  `t[char]`  |         下一个 char 的上一个字符          |                      t = to                       |
|  `T[char]`  |         下一个 char 的下一个字符          |                                                   |
| `[number]G` |               第 number 行                |                                                   |
| `:[number]` |                                           |                                                   |
| `[number]%` |               文件 number %               |                                                   |
|     `H`     |                屏幕第一行                 |                     H = head                      |
|     `M`     |                窗口中间行                 |                    M = middle                     |
|     `L`     |               窗口最后一行                |                     L = last                      |

## 窗口滚动

|    按键    |   意义   |     备注     |
| :--------: | :------: | :----------: |
|  `<C-f>`   |  下一页  | f = forward  |
|  `<PgDn>`  |          |              |
|  `<C-b>`   |  上一页  | b = backward |
|  `<PgUp>`  |          |              |
|  `<C-d>`   |  下半页  |   d = down   |
|  `<C-u>`   |  上半页  |    u = up    |
|  `<C-e>`   |  下一行  |              |
|  `<C-y>`   |  上一行  |              |
|    `zz`    | 屏幕中间 |              |
|    `z.`    |          |              |
|    `zt`    | 屏幕顶部 |   t = top    |
| `z<Enter>` |          |              |
|    `zb`    | 屏幕底部 |  b = bottom  |
|    `z-`    |          |              |

## 插入

| 按键 |       意义       |      备注       |
| :--: | :--------------: | :-------------: |
| `a`  |    光标后插入    |   a = append    |
| `i`  |    光标前插入    |   I = insert    |
| `A`  |     行尾插入     |                 |
| `I`  |     行前插入     |                 |
| `o`  | 新增下一行并插入 | o = open a line |
| `O`  | 新增上一行并插入 |                 |

插入模式下的一些快捷键

|    按键    |          意义          |       备注        |
| :--------: | :--------------------: | :---------------: |
|  `<C-h>`   |     删除上一个字符     | 等同于 `<Delete>` |
|  `<C-w>`   | 删除前一个字符到单词头 |                   |
|  `<C-u>`   |        删除正行        |                   |
| `<C-r>reg` |    粘帖寄存器的内容    |                   |

## 复制

vim 的复制，单词是 yank，不是 copy

语法：

- `[" reg] y [number] motion`
- `[" reg] [number] + yy`：复制当前及下面共 `number` 行

## 粘帖

语法：

- `[number] [" reg] p/P`

|       按键       |             意义             |                备注                |
| :--------------: | :--------------------------: | :--------------------------------: |
|       `p`        |          光标后黏贴          | 若内容多余一行，将内容黏贴到下一行 |
|       `P`        |          光标前黏贴          | 若内容多于一行，将内容黏贴到上一行 |
|       `gp`       | 下一行粘帖，并跳到下一行行首 |                                    |
|       `gP`       | 上一行粘帖，并跳到上一行行首 |                                    |
| `<shift+Insert>` |          黏贴剪贴板          |                                    |

## 删除

在 vim 中删除就是剪切

语法：

- `[number] [" reg"] d motion`

|    按键    |      意义      | 备注 |
| :--------: | :------------: | :--: |
| `<Delete>` |  光标所在字符  |      |
|    `dl`    |                |      |
|    `x`     |                |      |
|    `dh`    |  光标前面字符  |      |
|    `X`     |                |      |
|    `D`     | 光标所在至行尾 |      |
|    `d$`    |                |      |

## 更改

语法：

- `[number] c motion`：等价于 `[number] d motion a`

其他更改的快捷命令

| 按键 |             意义             |       备注       |
| :--: | :--------------------------: | :--------------: |
| `s`  |     删除光标下字符并插入     |                  |
| `S`  |     删除光标所在行并插入     | 换行符没有被删除 |
| `cc` |                              |                  |
| `c$` | 删除光标所在字符至行尾并插入 |                  |
| `C`  |                              |                  |

## 撤销

|  按键   |       意义       |   备注   |
| :-----: | :--------------: | :------: |
|   `u`   |     撤销修改     | u = undo |
|   `U`   | 撤销对整行的修改 |          |
| `<C-r>` |  恢复撤销的内容  |          |

## 查找

### motion 的查找

|   按键    |                   意义                    |                 备注                  |
| :-------: | :---------------------------------------: | :-----------------------------------: |
|    `%`    | 光标所在括号（`{`、`[`、`(`）相匹配的括号 |                                       |
| `f[char]` |                下一个 char                | `;`重复刚才的查找，`,` 反向刚才的查找 |
| `F[char]` |                上一个 char                |                                       |
| `t[char]` |         下一个 char 的上一个字符          |                                       |
| `T[char]` |         下一个 char 的下一个字符          |                                       |

### 快速查找

|   按键    |                意义                |                 备注                  |
| :-------: | :--------------------------------: | :-----------------------------------: |
|    `*`    | 向前查找与光标下字符串匹配的字符串 |                                       |
|    `#`    | 向后查找与光标下字符串匹配的字符串 |                                       |
|   `g*`    | 向前查找与光标下字符串相近的字符串 |                                       |
|   `g#`    | 向后查找与光标下字符串相近的字符串 |                                       |

### 高级查找

语法：

- `\key`
- `?key`

| 按键 |   意义   |                  备注                  |
| :--: | :------: | :------------------------------------: |
| `/`  | 向前查找 | `n` 正向刚才的操作，`N` 反向刚才的操作 |
| `?`  | 向后查找 |                                        |

[正则表达式教程](https://vimjc.com/regex-for-vim-seach-substitute-global-command.html)

特殊的字符

- `.`
- `*`
- `[`
- `]`
- `^`：表示匹配输入字符串的开始位置 (行首)。
- `%`
- `/`
- `?`
- `~`
- `$`：表示匹配 输入字符串的结束位置 (行尾)。

### 多文件查找



## 替换

### 替换模式

| 按键 |        意义        | 备注 |
| :--: | :----------------: | :--: |
| `R`  |    进入替换模式    |      |
| `r`  |     单字符替换     |      |
| `gR` |  进入虚拟替换模式  |      |
| `gr` | 进入单字符虚拟替换 |      |

syntax: [number] + r

如果指定 number，则是一次性将多个字符替换为同一个

输入`R`，进入替换模式：输入的字符都将替换光标所在的字符，如何替换错了，`Backspace` 可以帮忙撤销替换。

虚替换与替换的区别

- 替换模式（REPLACE）将<Tab>键作为一个整体来处理（不管其真实占用多少个空格位置）；而虚拟替换模式（VREPLACE）则将<Tab>键拆分为多个独立的空格来分别处理。如果文本以<Tab>分隔排布，在编辑过程中希望保持原有的文本缩进和排版格式，那么建议使用虚拟替换模式。
- 替换模式（REPLACE）下，输入<Enter>回车键将增加新行；在虚拟替换模式（VREPLACE）下，输入<Enter>回车键将用新行替代当前行内容（即清空当前行）：

###  高级替换

s = substitute

- `:s/old/new`：替换当前行第一个目标
- `:s/old/new/g`：替换当前行所有目标
- `%s/old/new/g`：替换整个文件所有目标
- `%s/old/new/gc`：交互式替换整个文件所有目标

- `y`: yes
- `n`: no
- `a`: all
- `q`: quit
- `l`: 替换第一个并进入插入模式
- `^E`：

- `5，13s/old/new/gc`：交互式替换5到13行所有目标

语法：`[scope]s\old\new\[flags]`

- scope
	- `m,n`：从第`m`到`n`行
		- `$`：文件结尾
		- 如果为空则表示当前行
		- 如果只有一个数字（没有`,`）则表示某一行
	- `%`：整个文件，等价于`1,$`
	- default：省略时，默认当前行
- text
-  
- flags
	- `g`：global，全局替换，即对所有匹配匹配结果进行替换
	- `c`：confirm，进行确认
		- `y`：yes
		- `n`：no
		- `a`：all
		- `q`：quit
		- `l`：last，替换第一个并进行插入模式
		- `^E`：向上滚动一行
		- `^Y`：向下滚动一行
	- `p`：替换结果逐行显示（`ctrl + l` 恢复屏幕）
	- `o`：ignore，不区分大小写
	- default：省略时仅对每行第一个匹配的结果进行替换

## 正则表达式

知乎那个很多

## file

|      按键       |                意义                |                     备注                      |
| :-------------: | :--------------------------------: | :-------------------------------------------: |
|      `:q`       |                退出                |          q = quit, a =all, ! = force          |
|      `:q!`      |              强制退出              |                                               |
|     `:qa!`      |            强制退出全部            |                                               |
| `:w [filename]` |                保存                | w = write，若有内容被选择，保存的是选择的内容 |
|      `:w!`      |              强制保存              |                                               |
|      `:wq`      |             保存并退出             |                                               |
|      `ZZ`       |                                    |                                               |
|     `:wq!`      |           强制保存并退出           |                                               |
|      `:wa`      |              保存全部              |                                               |
|     `:waq`      |           保存全部并退出           |                                               |
|     `:waq!`     |         强制保存全部并退出         |                                               |
|     `<C-g>`     |            查看文件信息            |                                               |
|  `:r filename`  | 读入文本，并粘帖到当前光标的下一行 |                                               |



## fold

| 按键 |            意义            | 备注 |
| :--: | :------------------------: | :--: |
| `zo` |          展开当前          |      |
| `zc` |          折叠当前          |      |
| `za` |        切换当前折叠        |      |
| `zR` | 展开所有折叠及其嵌套的折叠 |      |
| `zr` |        展开所有折叠        |      |
| `zM` |     折叠所有（含嵌套）     |      |
| `zm` |          折叠所有          |      |
| `zE` |        删除所有折叠        |      |
| `zd` |        删除当前折叠        |      |
| `zn` |          禁用折叠          |      |
| `zN` |          开启折叠          |      |
| `zj` |      移动到下一个折叠      |      |
| `zk` |      移动到上一个折叠      |      |

## 补全

|       按键        |   意义   |                             备注                             |
| :---------------: | :------: | :----------------------------------------------------------: |
| `<C-n>` / `<C-p>` | 单词补全 | `<C-n>` 表示向下选择，`<C-p>` 则向上选择，n = next, p = previous |
|   `<C-x><C-l>`    |  行补全  |                       `<C-l>` 向下选择                       |
|   `<C-x><C-f>`    | 路径补全 |                       `<C-f>`向下选择                        |
|   `<C-x><C-o>`    | 代码补全 |      `<C-o>` 向下选择，需要`filetype on` 并安装相关插件      |

## format

| 按键 |    意义    |      备注       |
| :--: | :--------: | :-------------: |
| `=`  | 格式化代码 | V模式选择，再按 |
|      |            |                 |
|      |            |                 |

## 缩进

语法：

- `[number] >>/<<`：当前及余下共 `number` 缩进/反缩进

| 按键 |  意义  | 备注 |
| :--: | :----: | :--: |
| `>>` |  缩进  |      |
| `<<` | 反缩进 |      |

## visual

|  按键   |             意义             | 备注 |
| :-----: | :--------------------------: | :--: |
|   `v`   |        字符可视化模式        |      |
|   `V`   |         行可视化模式         |      |
| `<C-v>` |         块可视化模式         |      |
| `<C-q>` |                              |      |
|  `gv`   |  选中前一次可视化选中的文本  |      |
|   `o`   | 光标移动到选中文本的另一结尾 |      |
|   `O`   | 光标移动到选中文本的另一角落 |      |

多行多列编辑

1. `<C-v>` 进行块可视化模型
2. 使用 `motion` 进行选择
3. 进行编辑
	- 可以使用 `d` 进行删除
	- `shift + i` 进行插入相应的内容，再按 `esc` 实现插入的更新

## cmd

命令行模式的快捷键

|    按键     |        意义        | 备注 |
| :---------: | :----------------: | :--: |
|     `↑`     |     上一条命令     |      |
|   `<C-p>`   |                    |      |
|     `↓`     |     下一条命令     |      |
|   `<C-n>`   |                    |      |
|   `<C-b>`   |      命令开头      |      |
|  `<Home>`   |                    |      |
|   `<C-e>`   |      命令结尾      |      |
|   `<End>`   |                    |      |
| `<Shift-→>` |    向右一个单词    |      |
|   `<C-→>`   |                    |      |
| `<Shift-←>` |    向左一个单词    |      |
|   `<C-←>`   |                    |      |
|   `<C-w>`   | 删除光标前一个单词 |      |
|   `<C-u>`   | 删除光标前所有单词 |      |

|    按键     |        意义        | 备注 |
| :---------: | :----------------: | :--: |
|   `!cmd`    |     运行 `cmd`     |      |
|`:help [key]`|查看 `key` 的帮助|

## windows

新建窗口

|     按键     |       意义       |                    备注                     |
| :----------: | :--------------: | :-----------------------------------------: |
|   `:sp [file]`   |        水平分割窗口         | sp = split v =vertical 默认 file 为当前文件 |
|   `:vs [file]`   |        垂直分割窗口         |                                             |
|      `:new`      |      新建水平分割窗口       |                                             |
|     `:vnew`      |      新建垂直分割窗口       |                                             |

切换窗口

|       按键       |            意义             |                    备注                     |
| :--------------: | :-------------------------: | :-----------------------------------------: |
|     `<C-w>w`     |     在各个分屏循环移动      |                                             |
|     `<C-w>h`     |        切换左边分屏         |                                             |
|     `<C-w>j`     |        切换下边分屏         |                                             |
|     `<C-w>k`     |        切换上边分屏         |                                             |
|     `<C-w>l`     |        切换右边分屏         |                                             |
|     `<C-w>t`     |       切换最上面分屏        |                   t = top                   |
|     `<C-w>b`     |       切换最下面分屏        |                 b = bottom                  |
|     `<C-w>p`     |      切换为刚才的窗口       |                                             |

移动窗口

|       按键       |            意义             |                    备注                     |
| :--------------: | :-------------------------: | :-----------------------------------------: |
|`<C-w>r`|向右或向下循环移动窗口|xx|
|`<C-w>R`|向左或向下循环移动窗口||
|`<C-w>x`|将当前窗口与下一个窗口位置对换|若没有下一窗口，则与顶部窗口对换|
|`<C-w>K`|将当前窗口放到最顶端，并使用最大屏幕宽度||
|`<C-w>J`|将当前窗口放到最顶端，并使用最大屏幕宽度||
|`<C-w>H`|将当前窗口放到最底端，并使用最大屏幕宽度||
|`<C-w>L`|将当前窗口放到最左端，并使用最大屏幕高度||
|`<C-w>T`|将当前窗口放到最右端，并使用最大屏幕高度||

改变窗口大小

|         按键          |            意义             | 备注 |
| :-------------------: | :-------------------------: | :--: |
|       `<C-w>+`        |    当前窗口高度增加一行     |      |
|       `<C-w>-`        |    当前窗口高度减少一行     |      |
|     `:resize +n`      |   当前窗口高度增加 `n` 行   |      |
|     `:resize -n`      |   当前窗口高度减少 `n` 行   |      |
|       `<C-w>>`        |    当前窗口宽度增加一列     |      |
|       `<C-w><`        |    当前窗口宽度减少一列     |      |
| `:vertical resize +n` |   当前窗口宽度增加 `n` 列   |      |
| `:vertical resize -n` |   当前窗口宽度减少 `n` 列   |      |
|       `<C-w>_`        |     使当前窗口高度最大      |      |
|       `<C-w>|`        |     使当前窗口宽度最大      |      |
|   `[number]<C-w>_`    | 使当前窗口容纳行数为 number |      |
|   `[number]<C-w>|`    | 使当前窗口容纳列数为 number |      |
|       `<C-w>=`        |     使所有窗口大小相等      |      |

关闭窗口

|         按键          |            意义             | 备注 |
| :-------------------: | :-------------------------: | :--: |
|       `<C-w>q`        |        关闭当前分屏         |      |
|       `:close`        |                             |      |
|       `<C-w>o`        |    关闭除当前外所有分屏     |      |
|        `:only`        |                             |      |


## 多文件



`vim -o file1 file2`：水平编辑编辑多个文件

`vim -O file1 file2`：垂直编辑多个文件

## 文本处理

`gU`：大写
`gu`：小写

排序

合并

换行

拼写检查

## 宏

normal 模式下，使用q来进行录制，也是q结束

q{register} 选择保存的寄存器，开始录制的时候
@{register} 回放寄存器的命令

如果v模式下，按下：，会出现:'<,>' 输入normal I"，则是在选中的行插入”

## 多文件

`:edit! filename`：放弃当前修改的文件并编辑新的文件

buffer: 一个文件的缓冲区

window：buffer 可视化的分割区域

tab：组织窗口得为一个工作区

ls：列出当前打开的文件数（缓冲区）

b + 数字/文件名：跳转文件
bprev:上一个缓冲区
blast：下一个缓冲区

## 寄存器

| 类别             | 符号     | 描述                   |
| ---------------- | -------- | ---------------------- |
| 未命名寄存器     | `"`      | 上一次复制或删除的文本 |
| 数字寄存器       | `0-9`    | 文本复制和删除历史     |
| 行内删除寄存器   | `-`      | 删除少于一行的文本     |
| 命名寄存器       | `a-zA-Z` | 存放文本               |
| 只读寄存器       | `%`      | 当前文件名             |
|                  | `.`      | 最近插入的文本         |
|                  | `:`      | 最近执行的命令行       |
| 轮换缓冲区寄存器 | `#`      | 交换文件的名字         |
| 表达式寄存器     | `=`      | 返回表达式结果         |
| 选择和拖拽寄存器 | `*`      | 系统剪切板             |
|                  | `+`      | 系统剪切板（X11）      |
|                  | `~`      | 拖拽的文本             |
| 黑洞寄存器       | `_`      | 彻底删除的文本         |
| 探索模型寄存器   | `/`      | 最近搜索模型           |

`:reg x`：查看寄存器 `x` 的内容

## 缓冲区

缓冲区的状态码

| 标志符 |                        描述                         | 备注 |
| :----: | :-------------------------------------------------: | :--: |
|  `-`   | readonly buffer，禁用了 modifiable 选项，只读缓冲区 |      |
|  `=`   |             readonly buffer，只读缓冲区             |      |
|  `a`   |    activate buffer，活动缓冲区，当前显示在屏幕上    |      |
|  `h`   | hidden buffer，隐藏缓冲区，已载入但没有显示在屏幕上 |      |
|  `+`   |          modified buffer，已经更改的缓冲区          |      |
|  `x`   |                    error buffer                     |      |
|  `%`   |             current buffer，当前缓冲区              |      |
|  `#`   |            alternate buffer，交换缓冲区             |      |
|  `u`   |  unlisted buffer，只在使用!修饰符才能显示的缓冲区   |      |

|       命令        |        描述        |         备注         |
| :---------------: | :----------------: | :------------------: |
| `:badd filename`  |     增加缓冲区     |                      |
|       `:ls`       |     列出缓冲区     |                      |
|     `:files`      |                    |                      |
|    `:buffers`     |                    |                      |
|       `:bn`       |     下一缓冲区     | b = buffer, n = next |
|       `:bp`       |     上一缓冲区     |     p = previous     |
|       `:bN`       |                    |                      |
|       `:bl`       |  到最后一个缓冲区  |       l = last       |
|       `:bf`       |   到第一个缓冲区   |      f = first       |
|   `:bmodified`    |  到修改过的缓冲区  |                      |
| `:buffer number`  |     编辑缓冲区     |                      |
|      `:ball`      |   编辑所有缓冲区   |      b = buffer      |
| `:bdelete number` |     删除缓冲区     |                      |
|    `:bunload`     | 从内存中卸载缓冲区 |                      |

## 标签

|        命令         |            描述            |                  备注                  |
| :-----------------: | :------------------------: | :------------------------------------: |
|      `:tabnew`      |         新建标签页         |                                        |
| `:tabedit filename` |      新标签页打开文件      |                                        |
|     `:tabfind`      | 查找并在新标签页中打开文件 |                                        |
|       `:tabs`       |          列出标签          | `>` 标记当前标签，`+` 标记已更改的标签 |
|     `:tabclose`     |        关闭当前标签        |                                        |
|     `:tabonly`      |       仅保留当前标签       |                                        |
|       `:tabn`       |      切换到下一个标签      |                n = next                |
|        `gt`         |                            |                                        |
|     `<C-PgDn>`      |                            |                                        |
|       `:tabp`       |      切换到上一个标签      |              p = previous              |
|        `gT`         |                            |                                        |
|     `<C-PgUp>`      |                            |                                        |
|     `:tabfirst`     |      切换到第一个标签      |                                        |
|     `:tablast`      |     切换到最后一个标签     |                                        |
|    `:tabm index`    |  将当前标签放置到指定位置  | `index`  从 0 开始，若无指定，默认最后 |
|    `:tabdo cmd`     |    在所有标签执行 `cmd`    |                                        |

